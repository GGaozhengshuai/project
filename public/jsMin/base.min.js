/*! tyc 2015-12-08 */
var userCtrls=angular.module("userCtrls",["userServices"]);userCtrls.controller("pwdCtrl",["$scope","pwdServices",function(a,b){}]),userCtrls.controller("loginOutCtrl",["$scope","loginOutServices",function(a,b){a.loginOut=function(){var a=b.loginOut();a.success(function(a){200==a.code?window.location.href="login.html":alert("退出失败，请重新退出")}).error(function(a){alert(a)})}}]),userCtrls.controller("addUserCtrl",["$scope","userServices",function(a,b){a.addData={},a.submit=function(){var a=b.addUser(this.addData);a.success(function(a){200==a.code?swal("用户添加成功","","success"):swal("用户添加失败，请重新添加","","error")}).error(function(a){alert(a)})}}]),userCtrls.controller("UserListCtrl",["$scope","userServices",function(a,b){a.listUser=function(){var c=b.listUser();c.success(function(b){200==b.code?a.userList=b.rst.data:alert("添加失败,请重新添加")}).error(function(a){alert(a)})}(),a.deleteUser=function(c){swal({title:"确定删除此用户吗？",text:"",type:"warning",showCancelButton:!0,cancelButtonText:"取消",confirmButtonColor:"#DD6B55",confirmButtonText:"确定"},function(){var d=a.userList[c],e=b.deleteUser({_id:d._id});e.success(function(b){200==b.code?(a.userList.splice(c,1),alert("删除成功")):alert("删除失败")}).error(function(a){alert(a)})})},a.del_arr=[],a.ck=[],a.check=function(b,c){var d=a.userList[b]._id,e=a.del_arr.indexOf(d);e>-1&&0==c?a.del_arr.splice(e,1):-1==e&&1==c&&a.del_arr.push(d),a.del_arr.length==a.userList.length?a.ck_all=!0:a.ck_all=!1},a.checkall=function(b){if(1==b){a.del_arr=[];for(var c=0;c<a.userList.length;c++)a.del_arr.push(a.userList[c]._id),a.ck[c]=!0}else{for(var c=0;c<a.userList.length;c++)a.ck[c]=!1;a.del_arr=[]}console.log(a.del_arr)},a.del=function(){console.log(a.del_arr)}}]),userCtrls.controller("viewUserCtrl",["$scope","$route","userServices",function(a,b,c){var d=c.viewUser({_id:b.current.params.id});d.success(function(b){200==b.code&&(console.log(b),a.viewUser=b.rst.data)}).error(function(a){alert(a)})}]),userCtrls.controller("editUserCtrl",["$scope","$route","userServices",function(a,b,c){var d=c.viewUser({_id:b.current.params.id});a.editUser={},d.success(function(b){200==b.code&&(a.editUser=b.rst.data)}).error(function(a){alert(a)}),a.submit=function(){console.log(this.editUser);var a=c.editUser(this.editUser);a.success(function(a){200==a.code?alert("修改成功"):alert("修改失败")}).error(function(a){alert(a)})}}]),userApp.controller("aaaC",function(a){a.formData={},a.submit=function(){console.log(this.formData)}});var usrDirectives=angular.module("usrDirectives",[]);usrDirectives.directive("userDirective_1",["$scope",function(a){}]),usrDirectives.directive("userDirective_2",["$scope",function(a){}]);var userFilters=angular.module("userFilters",[]);userFilters.filter("userFilter_1",["$scope",function(a){}]),userFilters.filter("userFilter_2",["$scope",function(a){}]);var loginApp=angular.module("loginApp",[]);loginApp.factory("User",function(a){var b={user_name_validate:function(a){var b,c=/^[a-zA-Z0-9]{3,16}/;return 0==a.length?b="请输入用户名":0==a.length||c.test(a)?0!=a.length&&c.test(a)&&(b=""):b="请输入格式正确的用户名",b},password_validate:function(a){var b;return 0==a.length&&(b="请输入密码"),b},getLogin:function(b){return a.post("/page/login",b)}};return b}),loginApp.directive("loading",function(){return{restrict:"AECM",link:function(a,b,c){},template:'<div id="loading"><img src="img/loading.gif"/></div>',replace:!0}}),loginApp.controller("loginController",function(a,b){a.login=function(){a.statueLoding=!0;var c=b.getLogin({login:a.user_name,password:a.password});c.success(function(b){200==b.code?window.location.href="index.html":a.passwordTip="登录名或密码错误！",a.statueLoding=!1}).error(function(b){a.statueLoding=!1,alert(b)})},a.name_validate=function(){a.nameTip=b.user_name_validate(a.user_name)},a.password_validate=function(){a.passwordTip=b.password_validate(a.password)}});var userServices=angular.module("userServices",[]);userServices.service("userServices",function(a){var b={addUser:function(b){return a.post("/service/users/add",b)},listUser:function(){return a.post("/service/users")},deleteUser:function(b){return a.post("/service/users/delete",b)},viewUser:function(b){return a.post("/service/users/view",b)},editUser:function(b){return a.post("/service/users/update",b)}};return b}),userServices.service("pwdServices",function(a){return{changePwd:function(a){}}}),userServices.service("loginOutServices",function(a){return{loginOut:function(){return a.get("/page/logout")}}});var module=angular.module("myAppTest",[]).module.controller("myController",["$scope",function(a){a.frameworks=["Node.js","Express","AnjularJS"]}]),userApp=angular.module("userApp",["ngRoute","ngAnimate","userCtrls","userServices"]);userApp.config(function(a){a.when("/pwd",{templateUrl:"../template/password.html",controller:"pwdCtrl"}).when("/addUser",{templateUrl:"../template/user/addUser.html",controller:"addUserCtrl"}).when("/editUser/:id/",{templateUrl:"../template/user/editUser.html",controller:"editUserCtrl"}).when("/viewUser/:id/",{templateUrl:"../template/user/viewUser.html",controller:"viewUserCtrl"}).when("/listUser",{templateUrl:"../template/user/listUser.html",controller:"UserListCtrl"}).otherwise({redirectTo:"/listUser"})});